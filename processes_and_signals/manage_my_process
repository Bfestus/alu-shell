#!/usr/bin/env bash
# This script manages the manage_my_process script.
# It can start, stop, or restart the process and maintains a PID file.

function manage_my_process() {
  while true; do
    echo "I am alive!" >> /tmp/my_process
    sleep 2
  done
}

# Start the process
function start() {
  manage_my_process &
  echo "manage_my_process started"
  pid=$(cat /var/run/my_process.pid)
  echo "$pid" > /var/run/my_process.pid
}

# Stop the process
function stop() {
  pid=$(cat /var/run/my_process.pid)
  kill $pid
  echo "manage_my_process stopped"
  rm -f /var/run/my_process.pid
}

# Restart the process
function restart() {
  stop
  start
}

case "$1" in
  start)
    start
    ;;
  stop)
    stop
    ;;
  restart)
    restart
    ;;
  *)
    echo "Usage: manage_my_process {start|stop|restart}"
    ;;
esac

